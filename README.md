# Solar-Simulator_IV_Sweep

Control Keithley 2401 + LabJack U3 + Newport LSH-7320 solar simulator via python.

K2401SS.py contains the code to communicate with the Keithley unit over GPIB, and with the Labjack over USB. The Labjack FIO4 is connected to the
trigger of the lamp to turn it on or off via a 3.5V TTL signal.  Manual lamp control is an option for circumstances when the LabJack unit cannot control the lamp. [Included for backwards compatibility.  In most cases use the newer version below.]

K2401SS_4_1.py This version implments maximum power point tracking and 4-wire mode.  Maybe a few other things that I can't think of as I'm writing this. [Use this version for the included Jupyter notebooks.]

db_dataverse.py and db_form.py   These files implement a modular approach to Dataverse support, as a layer on top of the modules in K2401SS_4_1.py. It is specific to Dataverse tables Sample_data and J-V_test_data. To set up the appropriate tables requires knowledge of Microsoft Azure, Power Apps, and Dataverse.   Samples of exported data have been provided  (see crf3d_sample_datas.csv and crf3d_jv_test_datas.csv) but I haven't attempted to develop detailed documentation on how to do it.

Solar_Simulator_IV_sweep_with_lamp_control_V3.ipynb: The IV-sweep Jupyter notebook implements Current-Voltage sweeps with the Keithley, while controlling whether the lamp is on or off for dark/light sweeps. A series of multiple sweeps can be produced, which is intended for PV cell degradation testing. Maximum Power Point (MPP) tracking has been implemented as an option by setting the K2401 output to the MPP voltage at the end of each sweep. Note that MPP does a full J-V scan at every time interval. The LabJact U3 support can also be disabled, reverting to manually switching the lamp on and off.

Solar_Simulator_IV_sweep_with_lamp_control_V3_MPP_4.ipynb  A newer version (5/62023) that implements 4-wire mode.   It requires either K2401SS_MPP_2.py or K2401SS_MPP_4.py depending on whether you are running in 2-wire or 4-wire mode.  It can also run with K2401SS_4_1.py with a minor update, but I don't have that updated version at hand as I am writing this.

Solar_Simulator_IV_sweep_with_lamp_control_V4s_verde.ipynb (6/9/2024)  Implements Dataverse interactivity.  It requires the files db_dataverse.py, db_form.py, and K2401SS_4_1.py.

IV_sweep_Timescan_Monitor_V1.ipynb: A Monitor Jupyter notebook is also included with an animated plot that tracks PV PCE as a function of time, using the data generated by the first notebook. This file has not been updated since the first commit, but it still works with the V3 scripts described above. Other monitoring scripts are in various stages of develoment, but are not included in this commit.

Solar_cell_IV_sweep_setup_instructions.txt: The instructions file contains setup details for Windows and were tested on Windows 11.
